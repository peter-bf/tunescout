{"ast":null,"code":"import React,{useState,useEffect,useCallback,useRef}from'react';import{useQuery}from'react-query';import{getLastFmTopArtists}from'./API';import ArtistCard from'./ArtistCard';import ArtistModal from'./ArtistModal';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Artists=()=>{const[selectedArtist,setSelectedArtist]=useState(null);const[isModalVisible,setIsModalVisible]=useState(false);const modalRef=useRef(null);const[currentPage,setCurrentPage]=useState(1);const[currentArtists,setCurrentArtists]=useState([]);const artistsPerPage=10;const{data:artists,error,isLoading}=useQuery('topArtists',getLastFmTopArtists);const handleArtistClick=useCallback(artist=>{setSelectedArtist(artist);setIsModalVisible(true);},[]);const closePopup=useCallback(()=>{setIsModalVisible(false);setTimeout(()=>{setSelectedArtist(null);},300);},[]);useEffect(()=>{const handleClickOutside=event=>{if(modalRef.current&&!modalRef.current.contains(event.target)){closePopup();}};if(isModalVisible){document.addEventListener('mousedown',handleClickOutside);}else{document.removeEventListener('mousedown',handleClickOutside);}return()=>{document.removeEventListener('mousedown',handleClickOutside);};},[isModalVisible,closePopup]);useEffect(()=>{if(artists){const sortedArtists=[...artists].sort((a,b)=>b.popularity-a.popularity);const indexOfLastArtist=currentPage*artistsPerPage;const indexOfFirstArtist=indexOfLastArtist-artistsPerPage;setCurrentArtists(sortedArtists.slice(indexOfFirstArtist,indexOfLastArtist));}},[artists,currentPage]);if(error)return/*#__PURE__*/_jsx(\"p\",{className:\"text-red-500 text-center mt-4\",children:\"Failed to fetch top artists\"});if(isLoading)return/*#__PURE__*/_jsx(\"p\",{className:\"text-center mt-4\",children:\"Loading...\"});const paginate=pageNumber=>{setCurrentArtists([]);// Clear current artists before updating the page\nsetCurrentPage(pageNumber);};const handlePreviousPage=()=>{if(currentPage>1)paginate(currentPage-1);};const handleNextPage=()=>{if(currentPage<Math.ceil(artists.length/artistsPerPage))paginate(currentPage+1);};return/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 mb-3\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-5xl font-bold text-center mb-5 text-red-600 py-3\",children:\"Top Artists\"}),/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center\",children:/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-5 gap-6\",children:currentArtists.map((artist,index)=>/*#__PURE__*/_jsx(ArtistCard,{artist:artist,index:(currentPage-1)*artistsPerPage+index,onClick:handleArtistClick},artist.id))})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-center mt-6\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:handlePreviousPage,className:\"px-4 py-2 mx-1 rounded \".concat(currentPage===1?'bg-gray-300 text-gray-500':'bg-white text-red-600'),disabled:currentPage===1,children:\"Previous\"}),artists&&Array.from({length:Math.ceil(artists.length/artistsPerPage)},(_,i)=>/*#__PURE__*/_jsx(\"button\",{onClick:()=>paginate(i+1),className:\"px-4 py-2 mx-1 rounded \".concat(i+1===currentPage?'bg-red-600 text-white':'bg-white text-red-600'),children:i+1},i+1)),/*#__PURE__*/_jsx(\"button\",{onClick:handleNextPage,className:\"px-4 py-2 mx-1 rounded \".concat(currentPage===Math.ceil(artists.length/artistsPerPage)?'bg-gray-300 text-gray-500':'bg-white text-red-600'),disabled:currentPage===Math.ceil(artists.length/artistsPerPage),children:\"Next\"})]}),selectedArtist&&/*#__PURE__*/_jsx(ArtistModal,{artist:selectedArtist,isVisible:isModalVisible,onClose:closePopup,modalRef:modalRef})]});};export default Artists;","map":{"version":3,"names":["React","useState","useEffect","useCallback","useRef","useQuery","getLastFmTopArtists","ArtistCard","ArtistModal","jsx","_jsx","jsxs","_jsxs","Artists","selectedArtist","setSelectedArtist","isModalVisible","setIsModalVisible","modalRef","currentPage","setCurrentPage","currentArtists","setCurrentArtists","artistsPerPage","data","artists","error","isLoading","handleArtistClick","artist","closePopup","setTimeout","handleClickOutside","event","current","contains","target","document","addEventListener","removeEventListener","sortedArtists","sort","a","b","popularity","indexOfLastArtist","indexOfFirstArtist","slice","className","children","paginate","pageNumber","handlePreviousPage","handleNextPage","Math","ceil","length","map","index","onClick","id","concat","disabled","Array","from","_","i","isVisible","onClose"],"sources":["/Users/peter/Documents/SUMMER 2024/SEG3125/tunescout/src/components/Artists.js"],"sourcesContent":["import React, { useState, useEffect, useCallback, useRef } from 'react';\nimport { useQuery } from 'react-query';\nimport { getLastFmTopArtists } from './API';\nimport ArtistCard from './ArtistCard';\nimport ArtistModal from './ArtistModal';\n\nconst Artists = () => {\n  const [selectedArtist, setSelectedArtist] = useState(null);\n  const [isModalVisible, setIsModalVisible] = useState(false);\n  const modalRef = useRef(null);\n  const [currentPage, setCurrentPage] = useState(1);\n  const [currentArtists, setCurrentArtists] = useState([]);\n  const artistsPerPage = 10;\n\n  const { data: artists, error, isLoading } = useQuery('topArtists', getLastFmTopArtists);\n\n  const handleArtistClick = useCallback((artist) => {\n    setSelectedArtist(artist);\n    setIsModalVisible(true);\n  }, []);\n\n  const closePopup = useCallback(() => {\n    setIsModalVisible(false);\n    setTimeout(() => {\n      setSelectedArtist(null);\n    }, 300);\n  }, []);\n\n  useEffect(() => {\n    const handleClickOutside = (event) => {\n      if (modalRef.current && !modalRef.current.contains(event.target)) {\n        closePopup();\n      }\n    };\n\n    if (isModalVisible) {\n      document.addEventListener('mousedown', handleClickOutside);\n    } else {\n      document.removeEventListener('mousedown', handleClickOutside);\n    }\n\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside);\n    };\n  }, [isModalVisible, closePopup]);\n\n  useEffect(() => {\n    if (artists) {\n      const sortedArtists = [...artists].sort((a, b) => b.popularity - a.popularity);\n      const indexOfLastArtist = currentPage * artistsPerPage;\n      const indexOfFirstArtist = indexOfLastArtist - artistsPerPage;\n      setCurrentArtists(sortedArtists.slice(indexOfFirstArtist, indexOfLastArtist));\n    }\n  }, [artists, currentPage]);\n\n  if (error) return <p className=\"text-red-500 text-center mt-4\">Failed to fetch top artists</p>;\n  if (isLoading) return <p className=\"text-center mt-4\">Loading...</p>;\n\n  const paginate = (pageNumber) => {\n    setCurrentArtists([]); // Clear current artists before updating the page\n    setCurrentPage(pageNumber);\n  };\n\n  const handlePreviousPage = () => {\n    if (currentPage > 1) paginate(currentPage - 1);\n  };\n\n  const handleNextPage = () => {\n    if (currentPage < Math.ceil(artists.length / artistsPerPage)) paginate(currentPage + 1);\n  };\n\n  return (\n    <div className=\"p-4 mb-3\">\n      <h1 className=\"text-5xl font-bold text-center mb-5 text-red-600 py-3\">Top Artists</h1>\n      <div className=\"flex justify-center\">\n        <div className=\"grid grid-cols-5 gap-6\">\n          {currentArtists.map((artist, index) => (\n            <ArtistCard \n              key={artist.id} \n              artist={artist} \n              index={(currentPage - 1) * artistsPerPage + index} \n              onClick={handleArtistClick} \n            />\n          ))}\n        </div>\n      </div>\n      <div className=\"flex justify-center mt-6\">\n        <button\n          onClick={handlePreviousPage}\n          className={`px-4 py-2 mx-1 rounded ${currentPage === 1 ? 'bg-gray-300 text-gray-500' : 'bg-white text-red-600'}`}\n          disabled={currentPage === 1}\n        >\n          Previous\n        </button>\n        {artists && Array.from({ length: Math.ceil(artists.length / artistsPerPage) }, (_, i) => (\n          <button\n            key={i + 1}\n            onClick={() => paginate(i + 1)}\n            className={`px-4 py-2 mx-1 rounded ${i + 1 === currentPage ? 'bg-red-600 text-white' : 'bg-white text-red-600'}`}\n          >\n            {i + 1}\n          </button>\n        ))}\n        <button\n          onClick={handleNextPage}\n          className={`px-4 py-2 mx-1 rounded ${currentPage === Math.ceil(artists.length / artistsPerPage) ? 'bg-gray-300 text-gray-500' : 'bg-white text-red-600'}`}\n          disabled={currentPage === Math.ceil(artists.length / artistsPerPage)}\n        >\n          Next\n        </button>\n      </div>\n      {selectedArtist && <ArtistModal artist={selectedArtist} isVisible={isModalVisible} onClose={closePopup} modalRef={modalRef} />}\n    </div>\n  );\n};\n\nexport default Artists;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}