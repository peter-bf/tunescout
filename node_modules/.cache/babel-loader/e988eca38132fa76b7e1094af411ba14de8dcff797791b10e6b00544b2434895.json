{"ast":null,"code":"import React,{useState,useEffect}from'react';import axios from'axios';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const clientId='7c6b8a3ea0e3406b9d8e5974be8b442b';const clientSecret='49aa02d0a85249279ae8ab73bbef28f5';const getSpotifyToken=async()=>{const response=await axios.post('https://accounts.spotify.com/api/token',null,{headers:{'Content-Type':'application/x-www-form-urlencoded','Authorization':\"Basic \".concat(btoa(\"\".concat(clientId,\":\").concat(clientSecret)))},params:{grant_type:'client_credentials'}});return response.data.access_token;};const getSpotifyTopTracks=async()=>{const token=await getSpotifyToken();const response=await axios.get('https://api.spotify.com/v1/playlists/37i9dQZEVXbMDoHDwVN2tF/tracks',{headers:{'Authorization':\"Bearer \".concat(token)},params:{market:'US',limit:25}});return response.data.items.map(item=>{var _item$track$album$ima;return{name:item.track.name,artist:item.track.artists[0].name,image:((_item$track$album$ima=item.track.album.images[1])===null||_item$track$album$ima===void 0?void 0:_item$track$album$ima.url)||''};});};const getLastFmStreams=async(track,artist)=>{try{const response=await axios.get('http://ws.audioscrobbler.com/2.0/',{params:{method:'track.getInfo',api_key:'28c425ac5fe3a7288e17efe8d7f9f82c',// Replace with your Last.fm API key\nartist:artist,track:track,format:'json'}});if(response.data&&response.data.track){return response.data.track.playcount;}}catch(err){console.error('Failed to fetch Last.fm streams',err);}return'N/A';};const Card=()=>{const[tracks,setTracks]=useState([]);const[error,setError]=useState('');useEffect(()=>{const fetchTracks=async()=>{try{const spotifyTracks=await getSpotifyTopTracks();const tracksWithStreams=await Promise.all(spotifyTracks.map(async spotifyTrack=>{const playcount=await getLastFmStreams(spotifyTrack.name,spotifyTrack.artist);return{...spotifyTrack,playcount};}));setTracks(tracksWithStreams);setError('');}catch(err){setError('Failed to fetch top songs');}};fetchTracks();},[]);const formatNumber=num=>{return num.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g,\",\");};const topSixTracks=tracks.slice(0,6);const remainingTracks=tracks.slice(6,19);// Limit to 15 more tracks\nreturn/*#__PURE__*/_jsxs(\"div\",{className:\"p-4\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-5xl font-bold text-center mb-4 text-red-600\",children:\"Trending\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-1/2 pr-4 grid grid-cols-3 gap-4\",children:topSixTracks.map((track,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-md overflow-hidden\",children:[/*#__PURE__*/_jsx(\"img\",{src:track.image,alt:track.name,className:\"w-full h-48 object-cover\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-4\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"font-bold text-lg mb-2 truncate\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"mr-2\",children:[index+1,\".\"]}),track.name]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-red-600 truncate\",children:track.artist}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-black-500 mt-2\",children:[\"Streams: \",formatNumber(track.playcount)]})]})]},index))}),/*#__PURE__*/_jsx(\"div\",{className:\"w-1/2 pl-4\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-white rounded-lg shadow-md overflow-hidden\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"w-full\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"bg-zinc-900/100 text-accent\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-2 text-left\",children:\"#\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-2 text-left\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-2 text-left\",children:\"Name\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-2 text-left\",children:\"Artist\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-2 text-right\",children:\"Streams\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:remainingTracks.map((track,index)=>/*#__PURE__*/_jsxs(\"tr\",{className:index%2===0?'bg-primary/20':'bg-accent/10',children:[/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-2\",children:index+7}),/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-2\",children:/*#__PURE__*/_jsx(\"img\",{src:track.image,alt:track.name,className:\"w-8 h-8 object-cover\"})}),/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-2 truncate\",children:track.name}),/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-2 truncate\",children:track.artist}),/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-2 text-right\",children:formatNumber(track.playcount)})]},index))})]})})})]}),error&&/*#__PURE__*/_jsx(\"p\",{className:\"text-red-500 text-center mt-4\",children:error})]});};export default Card;","map":{"version":3,"names":["React","useState","useEffect","axios","jsx","_jsx","jsxs","_jsxs","clientId","clientSecret","getSpotifyToken","response","post","headers","concat","btoa","params","grant_type","data","access_token","getSpotifyTopTracks","token","get","market","limit","items","map","item","_item$track$album$ima","name","track","artist","artists","image","album","images","url","getLastFmStreams","method","api_key","format","playcount","err","console","error","Card","tracks","setTracks","setError","fetchTracks","spotifyTracks","tracksWithStreams","Promise","all","spotifyTrack","formatNumber","num","toString","replace","topSixTracks","slice","remainingTracks","className","children","index","src","alt"],"sources":["/Users/peter/Documents/SUMMER 2024/SEG3125/tunescout/src/components/Card.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport axios from 'axios';\n\nconst clientId = '7c6b8a3ea0e3406b9d8e5974be8b442b';\nconst clientSecret = '49aa02d0a85249279ae8ab73bbef28f5';\n\nconst getSpotifyToken = async () => {\n  const response = await axios.post('https://accounts.spotify.com/api/token', null, {\n    headers: {\n      'Content-Type': 'application/x-www-form-urlencoded',\n      'Authorization': `Basic ${btoa(`${clientId}:${clientSecret}`)}`\n    },\n    params: {\n      grant_type: 'client_credentials'\n    }\n  });\n\n  return response.data.access_token;\n};\n\nconst getSpotifyTopTracks = async () => {\n  const token = await getSpotifyToken();\n  const response = await axios.get('https://api.spotify.com/v1/playlists/37i9dQZEVXbMDoHDwVN2tF/tracks', {\n    headers: {\n      'Authorization': `Bearer ${token}`\n    },\n    params: {\n      market: 'US',\n      limit: 25\n    }\n  });\n\n  return response.data.items.map(item => ({\n    name: item.track.name,\n    artist: item.track.artists[0].name,\n    image: item.track.album.images[1]?.url || '',\n  }));\n};\n\nconst getLastFmStreams = async (track, artist) => {\n  try {\n    const response = await axios.get('http://ws.audioscrobbler.com/2.0/', {\n      params: {\n        method: 'track.getInfo',\n        api_key: '28c425ac5fe3a7288e17efe8d7f9f82c', // Replace with your Last.fm API key\n        artist: artist,\n        track: track,\n        format: 'json'\n      }\n    });\n    if (response.data && response.data.track) {\n      return response.data.track.playcount;\n    }\n  } catch (err) {\n    console.error('Failed to fetch Last.fm streams', err);\n  }\n  return 'N/A';\n};\n\nconst Card = () => {\n  const [tracks, setTracks] = useState([]);\n  const [error, setError] = useState('');\n\n  useEffect(() => {\n    const fetchTracks = async () => {\n      try {\n        const spotifyTracks = await getSpotifyTopTracks();\n\n        const tracksWithStreams = await Promise.all(spotifyTracks.map(async (spotifyTrack) => {\n          const playcount = await getLastFmStreams(spotifyTrack.name, spotifyTrack.artist);\n          return {\n            ...spotifyTrack,\n            playcount\n          };\n        }));\n\n        setTracks(tracksWithStreams);\n        setError('');\n      } catch (err) {\n        setError('Failed to fetch top songs');\n      }\n    };\n    fetchTracks();\n  }, []);\n\n  const formatNumber = (num) => {\n    return num.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\n  };\n\n  const topSixTracks = tracks.slice(0, 6);\n  const remainingTracks = tracks.slice(6, 19); // Limit to 15 more tracks\n\n  return (\n    <div className=\"p-4\">\n      <h1 className=\"text-5xl font-bold text-center mb-4 text-red-600\">Trending</h1>\n      <div className=\"flex\">\n        {/* Top 6 tracks */}\n        <div className=\"w-1/2 pr-4 grid grid-cols-3 gap-4\">\n          {topSixTracks.map((track, index) => (\n            <div key={index} className=\"bg-white rounded-lg shadow-md overflow-hidden\">\n              <img src={track.image} alt={track.name} className=\"w-full h-48 object-cover\" />\n              <div className=\"p-4\">\n                <h3 className=\"font-bold text-lg mb-2 truncate\">\n                  <span className=\"mr-2\">{index + 1}.</span>{track.name}\n                </h3>\n                <p className=\"text-sm text-red-600 truncate\">{track.artist}</p>\n                <p className=\"text-sm text-black-500 mt-2\">Streams: {formatNumber(track.playcount)}</p>\n              </div>\n            </div>\n          ))}\n        </div>\n        {/* Remaining tracks table */}\n        <div className=\"w-1/2 pl-4\">\n          <div className=\"bg-white rounded-lg shadow-md overflow-hidden\">\n            <table className=\"w-full\">\n              <thead className=\"bg-zinc-900/100 text-accent\">\n                <tr>\n                  <th className=\"px-4 py-2 text-left\">#</th>\n                  <th className=\"px-4 py-2 text-left\"></th>\n                  <th className=\"px-4 py-2 text-left\">Name</th>\n                  <th className=\"px-4 py-2 text-left\">Artist</th>\n                  <th className=\"px-4 py-2 text-right\">Streams</th>\n                </tr>\n              </thead>\n              <tbody>\n                {remainingTracks.map((track, index) => (\n                  <tr key={index} className={index % 2 === 0 ? 'bg-primary/20' : 'bg-accent/10'}>\n                    <td className=\"px-4 py-2\">{index + 7}</td>\n                    <td className=\"px-4 py-2\">\n                      <img src={track.image} alt={track.name} className=\"w-8 h-8 object-cover\" />\n                    </td>\n                    <td className=\"px-4 py-2 truncate\">{track.name}</td>\n                    <td className=\"px-4 py-2 truncate\">{track.artist}</td>\n                    <td className=\"px-4 py-2 text-right\">{formatNumber(track.playcount)}</td>\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          </div>\n        </div>\n      </div>\n      {error && <p className=\"text-red-500 text-center mt-4\">{error}</p>}\n    </div>\n  );\n};\n\nexport default Card;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}